!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).pHash=e()}(this,function(){"use strict";var w=function(t,e){var r,n;return"undefined"===document?(r=require("canvas").createCanvas,n=r(e,e)):(n=document.createElement("canvas")).width=n.height=e,n.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,e,e),n},x=function(t,e,r){r=t.getContext("2d").getImageData(e,r,1,1).data;return[r[0],r[1],r[2],r[3]/255]},y=function(t){for(var e=[],r=t.length,n=0;n<r;n++){for(var o=0,a=0;a<r;a++)o+=t[a]*Math.cos(n*Math.PI*(a+.5)/r);o*=Math.sqrt(2/r),0==n&&(o*=1/Math.sqrt(2)),e[n]=o}return e},q=function(t){var e=t.length-1;return t.slice(1,e).reduce(function(t,e){return t+e},0)/e},C=function(t){return parseInt(t,2).toString(16)};return function(t){var e=(r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).size||32,r=r.debug||!1,n=w(t,e);r&&console.log('<img src="'.concat(n.toDataURL(),'" width="500" height="500" />'));for(var o=[],a=[],i=[],f=[],u=0;u<e;u++){for(var c=0;c<e;c++){var d=x(n,c,u);a[c]=parseInt(Math.floor(.299*d[0]+.587*d[1]+.114*d[2]))}i[u]=y(a)}for(var h=0;h<e;h++){for(var s=0;s<e;s++)f[s]=i[s][h];o[h]=y(f)}for(var v=[],g=0;g<8;g++)for(var l=0;l<8;l++)v.push(o[g][l]);for(var p=q(v),m=[],I=0,M=v;I<M.length;I++){var b=M[I];m.push(p<b?1:0)}return C(m.join(""))}});
